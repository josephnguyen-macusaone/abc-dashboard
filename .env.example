# =================================================================
# ABC DASHBOARD - CONSOLIDATED ENVIRONMENT CONFIGURATION
# =================================================================
# This single .env file is used for Docker Compose deployment
# Copy this file to .env and customize for your deployment
# cp .env.example .env
# =================================================================

# =================================================================
# ENVIRONMENT CONFIGURATION
# =================================================================
NODE_ENV=production

# =================================================================
# JWT CONFIGURATION
# =================================================================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-make-it-long-and-random
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=abc-dashboard
JWT_EMAIL_VERIFICATION_EXPIRES_IN=24h
JWT_PASSWORD_RESET_EXPIRES_IN=10m

# =================================================================
# CLIENT CONFIGURATION
# =================================================================
# Frontend origin (CORS, redirects). Use http://localhost:3000 when running via Docker.
CLIENT_URL=http://localhost:3000

# =================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =================================================================
# Full connection string. In Docker use host "postgres" and port 5432 (internal).
# When using encrypted password (below), leave DATABASE_URL unset; app builds URL from POSTGRES_*.
# DATABASE_URL=postgresql://abc_user:abc_password@postgres:5432/abc_dashboard
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=abc_dashboard
POSTGRES_USER=abc_user
# Plain value or enc:<hex> (generate: node backend/scripts/encrypt-db-password.js [password]).
# When using enc:..., start stack with: ./scripts/load-and-run.sh --start-only up -d  (not "docker compose up")
POSTGRES_PASSWORD=abc_password

# =================================================================
# EXTERNAL LICENSE API (optional; required for license sync)
# =================================================================
EXTERNAL_LICENSE_API_URL=
EXTERNAL_LICENSE_API_KEY=

# Sync schedule (cron). Default: every 30 min. For slow servers: 0 2 * * * (2 AM daily)
# LICENSE_SYNC_SCHEDULE=*/30 * * * *

# =================================================================
# CACHE CONFIGURATION (Redis)
# =================================================================
# Enable Redis (set false to use in-memory cache)
REDIS_ENABLED=true
# For Docker Compose: use redis://redis:6379 (hostname "redis" = service name in docker-compose).
# For local dev without Docker: use redis://localhost:6379
REDIS_URL=redis://redis:6379
CACHE_TYPE=redis
CACHE_USER_DATA_TTL=1800
CACHE_API_RESPONSE_TTL=300

# =================================================================
# ENCRYPTION CONFIGURATION
# =================================================================
# Backend: 64 hex chars (32 bytes) for AES-256. Required in production.
ENCRYPTION_KEY=
BCRYPT_ROUNDS=14

# =================================================================
# EMAIL CONFIGURATION
# =================================================================

# Email sender information
EMAIL_FROM=noreply@yourapp.com
EMAIL_FROM_NAME=ABC Dashboard

# Email Service Selection
EMAIL_SERVICE=gmail

# Development: MailHog (local email testing)
# EMAIL_HOST=localhost
# EMAIL_PORT=1025
# EMAIL_SECURE=false
# EMAIL_USER=
# EMAIL_PASS=

# Production: Gmail SMTP
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-email-app-password

# SendGrid Configuration (alternative to Gmail)
# SENDGRID_API_KEY=

# =================================================================
# FRONTEND CONFIGURATION
# =================================================================
# For local Docker: use port 5001 (backend is mapped 5001:5000). For local dev without Docker: use 5000.
NEXT_PUBLIC_USE_RELATIVE_API=false
# Docker: backend on host port 5001. Local dev: backend on 5000.
NEXT_PUBLIC_API_URL=http://localhost:5001/api/v1
NEXT_PUBLIC_APP_ENV=production

# Production: set NEXT_PUBLIC_USE_RELATIVE_API=true before build-and-save.sh
# so API and WebSocket use same origin (required for OLS proxy)

# WebSocket disabled by default (manual sync uses polling). Set true to enable.
# Single source: backend and frontend both use this value.
WEBSOCKET_ENABLED=false

# Optional: External Services
NEXT_PUBLIC_GA_TRACKING_ID=
NEXT_PUBLIC_SENTRY_DSN=

# =================================================================
# EMAIL SETUP INSTRUCTIONS
# =================================================================

# DEVELOPMENT (MailHog):
# 1. Install MailHog: brew install mailhog (macOS) or download from https://github.com/mailhog/MailHog
# 2. Start MailHog: mailhog
# 3. Access web interface: http://localhost:8025
# 4. Set EMAIL_SERVICE=mailhog and configure localhost settings above

# PRODUCTION (Gmail):
# 1. Enable 2-Factor Authentication on your Gmail account
# 2. Generate an App Password: https://support.google.com/accounts/answer/185833
# 3. Use your Gmail address as EMAIL_USER
# 4. Use the generated App Password as EMAIL_PASS
# 5. Keep EMAIL_SERVICE=gmail and Gmail config as shown above

# =================================================================
# SECURITY NOTES
# =================================================================
# - Never commit real credentials to version control
# - Use App Passwords for Gmail, not your main password
# - Use strong, unique JWT_SECRET in production
# - Test email functionality in development with MailHog first

# =================================================================
# DOCKER REGISTRY (Optional)
# =================================================================
# Uncomment if using a Docker registry
# DOCKER_REGISTRY=your-registry.com

# Next.js Server Actions Encryption Key (required for nuqs/Server Actions in Docker)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# Must be same value across builds; store securely and reuse.
NEXT_SERVER_ACTIONS_ENCRYPTION_KEY=
